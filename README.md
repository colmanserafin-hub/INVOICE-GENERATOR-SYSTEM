                                                                                                                                                            # Invoice Generator MVP

A professional, production-ready invoice generator backend (Python) with multiple input methods, sequential numbering, and polished PDF/HTML output. Includes dual PDF generation paths (WeasyPrint + ReportLab fallback) for maximum platform compatibility.

## Features

- **Professional PDF & HTML Templates**: Modern, print-ready layouts with company branding
- **Dual PDF Generation**: WeasyPrint (HTML-native fidelity) + ReportLab fallback (pure Python, zero native dependencies)
- **Polished UI Elements**:
  - Light gray header (#f8f9fa) with dark blue accent border and company details
  - Invoice metadata (Number, Date, Due Date) prominently displayed
  - Bill-to customer information section
  - Professional items table with alternating row colors (#f9fafb) for readability
  - Currency-formatted totals with subtotal, tax, discount, and total due
  - Payment instructions footer section (bank details, accepted methods)
  - Company footer message at bottom of page with terms
- **Multiple Input Methods**: Interactive manual entry, JSON file import, Excel file import
- **Sequential Invoice Numbering**: Auto-generated invoice numbers (INV-00001, INV-00002, etc.)
- **Date Handling**: Automatic invoice and due date calculation (configurable Net terms, default 30 days)
- **Logo Support**: Company logo from local file paths, URLs, or base64 data URIs
- **Configurable Branding**: Colors, company details, payment info, and footer messaging via centralized `config.py`
- **Audit Logging**: Invoice generation events logged to `logs/system.log` with timestamp and total amount

## Project Structure

```
invoice_generator_mvp/
├── main.py                          # Interactive invoice controller (3 input methods)
├── config.py                        # Centralized branding & payment configuration
├── smoke_no_pandas.py               # Non-interactive smoke test (generates sample invoice)
├── requirements.txt                 # Python dependencies
├── README.md                        # This file
│
├── templates/
│   └── invoice.html                 # Professional Jinja2 HTML template (WeasyPrint + browser)
│
├── utils/
│   ├── calculator.py               # Invoice math (subtotal, tax, discount, total)
│   ├── validator.py                # Data validation and integrity checks
│   ├── input_handler.py            # Manual/JSON/Excel input parsers
│   ├── pdf_generator.py            # Dual-path PDF generation (WeasyPrint + ReportLab)
│   └── logger.py                   # Audit trail logging
│
├── samples/
│   └── sample_invoice.json         # Example invoice data for testing
│
├── invoices/                        # Generated output directory (HTML/PDF)
├── logs/                            # Audit log directory (system.log)
│
└── docs/
    └── WEASYPRINT_WINDOWS.md       # Windows native library setup guide
```

## Quick Start (Windows PowerShell)

### Step 1: Set up Python environment

```powershell
# Navigate to project root
cd c:\Invoice_generator

# Create virtual environment
python -m venv .venv

# Activate virtual environment
& .venv\Scripts\Activate.ps1

# Upgrade pip
python -m pip install --upgrade pip
```

### Step 2: Install dependencies

```powershell
pip install -r invoice_generator_mvp/requirements.txt
```

### Step 3: Run the interactive invoice generator

```powershell
python invoice_generator_mvp/main.py
```

**Menu options:**
1. Manual entry — Enter company, customer, items interactively
2. JSON file — Load invoice data from `samples/sample_invoice.json` or custom JSON
3. Excel file — Load invoice data from `.xlsx` file

### Step 4: Test with smoke test (no user input required)

```powershell
python invoice_generator_mvp/smoke_no_pandas.py
```

Generates sample invoice in both HTML and PDF formats.

## Output Files

After running the generator:

| File Type | Location | Purpose |
|-----------|----------|---------|
| HTML Invoice | `invoice_generator_mvp/invoices/*.html` | Web-viewable invoice; also used by WeasyPrint for PDF |
| PDF Invoice | `invoice_generator_mvp/invoices/*.pdf` | Print-ready invoice (generated by WeasyPrint or ReportLab) |
| Audit Log | `invoice_generator_mvp/logs/system.log` | Timestamp, filename, total amount for each generated invoice |

## PDF Generation Strategy

The project uses a **dual-path PDF generation system** to maximize platform compatibility:

### Primary Path: WeasyPrint
- **Best for**: Maximum HTML/CSS fidelity, professional print-ready output
- **Requirement**: Native libraries on system (GTK, Cairo, Pango, GLib)
- **Status on Windows**: Requires manual setup (see `docs/WEASYPRINT_WINDOWS.md`)
- **Advantage**: Converts HTML template directly to PDF with full styling support

### Fallback Path: ReportLab
- **Best for**: Cross-platform compatibility, zero native dependencies
- **Advantage**: Pure Python—works immediately on all systems without additional installation
- **Output Quality**: Professional layout with:
  - Styled header with company branding (light gray background, dark blue accent)
  - Proper invoice metadata (number, date, due date)
  - Customer bill-to information
  - Professional items table with alternating row colors
  - Formatted currency totals section
  - Payment instructions footer at bottom of page
  - Company footer message

**How it works:**
1. Generator attempts WeasyPrint first
2. If native libraries unavailable, automatically falls back to ReportLab
3. Both produce professional, printable PDFs
4. User sees no difference in output quality

**Windows users**: If WeasyPrint libraries are not installed, ReportLab fallback activates automatically. No action required.

## Customization Guide

The project is designed to be easily customized. All branding and configuration lives in `config.py`.

### Edit Your Company Details

Open `invoice_generator_mvp/config.py` and update the `COMPANY` dictionary:

```python
COMPANY = {
    "name": "Your Company Name",
    "address": "123 Main Street",
    "city_state_zip": "Your City, State 12345",
    "phone": "+1 (555) 123-4567",
    "email": "hello@yourcompany.com",
    "website": "https://www.yourcompany.com",
    "logo_url": "C:/Users/YourName/Pictures/company_logo.jpg"  # Local path, URL, or base64
}
```

### Logo URL Options

The `logo_url` field supports three formats:

1. **Local file path** (Recommended):
   ```python
   "logo_url": "C:/Users/YourName/Pictures/serafin_logo.jpg"
   ```

2. **Online URL**:
   ```python
   "logo_url": "https://example.com/logo.png"
   ```

3. **Base64 data URI**:
   ```python
   "logo_url": "data:image/png;base64,iVBORw0KGgoAAAANS..."
   ```

### Payment Information

Update `PAYMENT_INFO` with your bank details:

```python
PAYMENT_INFO = {
    "bank_name": "Your Bank",
    "account_holder": "Your Name",
    "account_number": "12345678",
    "routing_number": "987654321",
    "swift_code": "ABCDUSXX",
    "methods": "Bank Transfer, Credit Card, Check"
}
```

### Invoice Settings

Customize invoice defaults:

```python
INVOICE_SETTINGS = {
    "default_due_days": 30,      # Net 30 terms
    "currency": "USD",           # Currency symbol
    "tax_label": "Sales Tax"     # Tax description
}
```

### Color Scheme

Modify the `COLORS` dictionary to match your brand:

```python
COLORS = {
    "header_bg": "#f8f9fa",      # Light gray header background
    "header_text": "#1a1a1a",    # Dark text for readability
    "header_accent": "#1f3c88",  # Dark blue accent border
    "text_light": "#666666",     # Secondary text
    "text_dark": "#1a1a1a",      # Primary text
    "border_light": "#e0e0e0",   # Light borders
    "table_alt_row": "#f9fafb",  # Alternating table rows
    "table_header_bg": "#f4f6f9", # Table header background
    "accent": "#ffb703",         # Amber accent (totals)
    # ... and more
}
```

### Footer Message

Customize the footer text that appears on every invoice:

```python
FOOTER_MESSAGE = "Thank you for your business. Please remit payment within terms."
```

**After editing `config.py`, run the generator again to see your changes applied.**

## Input Formats

### 1. Manual Interactive Input

Run `python invoice_generator_mvp/main.py` and select option 1. You'll be prompted to enter:
- Company name, address, phone, email
- Customer name, email
- Line items (description, quantity, unit price)
- Tax rate percentage
- Discount amount (optional)

### 2. JSON File Input

Create a JSON file with invoice data:

```json
{
  "company": {
    "name": "Acme Corporation",
    "address": "123 Business Ave",
    "city_state_zip": "New York, NY 10001",
    "phone": "+1 (212) 555-0100",
    "email": "billing@acme.com"
  },
  "customer": {
    "name": "John Doe",
    "email": "john@example.com"
  },
  "items": [
    {"description": "Web Design Services", "quantity": 10, "unit_price": 150.00},
    {"description": "Hosting (Annual)", "quantity": 1, "unit_price": 500.00}
  ],
  "tax_rate": 0.08,
  "discount": 0
}
```

Then run: `python invoice_generator_mvp/main.py` and select option 2.

### 3. Excel File Input

Create an `.xlsx` file with columns:
- `description` | `quantity` | `unit_price`

Plus metadata in first rows (company, customer, tax rate). Run option 3 in the interactive menu.

**Sample JSON:** See `invoice_generator_mvp/samples/sample_invoice.json` for complete example.

## Troubleshooting

### PDF Not Generated
- **Likely Cause**: WeasyPrint native libraries not installed on Windows
- **Solution**: ReportLab fallback should activate automatically. Check console output for "ReportLab (fallback)" message.
- **Alternative**: Follow `docs/WEASYPRINT_WINDOWS.md` to install WeasyPrint native libraries

### Logo Not Appearing in PDF
- **Verify**: Logo file exists at the path specified in `config.py`
- **Check**: Path uses forward slashes: `C:/path/to/logo.jpg` (not backslashes)
- **Test**: Use a local file path first; URLs may not work if network access is restricted

### Excel Import Failing
- **Cause**: `pandas` or `openpyxl` not installed
- **Solution**: Use JSON input instead, or run `pip install pandas openpyxl`

### Slow Initialization
- **Cause**: `pandas` import on first run
- **Note**: Subsequent runs are faster. Use `smoke_no_pandas.py` for pandas-free testing.

### WeasyPrint Installation Errors (Windows)
- **Reference**: See detailed instructions in `docs/WEASYPRINT_WINDOWS.md`
- **Requires**: MSYS2 toolchain and GTK/Cairo/Pango/GLib libraries

## Architecture

The project follows a **modular, single-responsibility** design:

- **`main.py`**: Orchestrates user input → validation → calculation → PDF generation → logging
- **`pdf_generator.py`**: Encapsulates WeasyPrint/ReportLab logic; user doesn't need to know which is active
- **`calculator.py`**: Pure math functions (no I/O)
- **`validator.py`**: Data integrity checks before processing
- **`input_handler.py`**: Accepts data from 3 sources (manual, JSON, Excel)
- **`logger.py`**: Audit trail to file
- **`config.py`**: Single source of truth for branding and settings

This design makes the project easy to extend (add new input formats, customize PDF layout, integrate with databases, etc.)

## Notes

- **Invoice Numbering**: Auto-incremented sequentially (INV-00001, INV-00002, etc.). Counter stored in generated invoices.
- **Dates**: Generated invoices include current date and auto-calculated due date (configurable Net terms)
- **Currency**: Formatted with thousand separators and currency symbol (configurable in `config.py`)
- **Platform**: Tested on Windows PowerShell; works on macOS and Linux with minor adjustments
- **HTML Output**: Also generated alongside PDF for web viewing and email distribution
- **Footer Positioning**: Footer message and payment info appear at the bottom of every page
- **Branding**: All visual elements (colors, fonts, footer) centralized in `config.py`

## Next Steps

1. **Customize `config.py`** with your company details and logo path
2. **Run the generator** and test with sample data
3. **Generate real invoices** using any of the three input methods
4. **Review output** in `invoices/` folder (HTML + PDF)
5. **Check logs** in `logs/system.log` for audit trail

## License

This repository is provided as-is for demo and learning purposes. Feel free to extend and customize.

---

**Questions or issues?** Review `config.py` for customization options, check `docs/WEASYPRINT_WINDOWS.md` for PDF generation help, or inspect `logs/system.log` for detailed audit trail.